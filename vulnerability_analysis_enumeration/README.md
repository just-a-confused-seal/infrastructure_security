## Vulnerability Analysis and Enumeration
Hi i hope you have a really good warm up session from the previous introduction section. Now let's get into more serious topic and its about vulnerability analysis.

### What is vulnerability analysis?
I think the best way to answer this question is to compare it with penetration testing. While both have the same purpose which is to find a vulnerability but the process itself is different.
You can say vulnerability analysis is more like to get a "Hypothesis" of a vulnerability by that means you are not 100% sure that if the vulnerability exist nor can be exploitable, on the other hand penetration testing is to proof that your "Hypothesis" is correct or you should show the proof of concept that the vulnerability can be exploited and it can affect the business side of the company.

### Understanding Vulnerability Analysis!
This is very important to understand because some people thinks doing penetration testing can be executed by just using automated tools or AI agent. Those tools are not yet capable to navigate and understanding the whole context, thus, making it very dangerous if we are too reliant with this tools. 
But you also need to realize that these tool can be used make things efficient and faster, so the goal is to make cyber security engineer to self reliant and able to utilize these tools to its full capability for their day to day work.

## Get your hands dirty
In this section we are going to use Nuclei. Nuceli is a vulnerability scanner written with Go that can be leverage using YAML-based templates.
To install nuclei, we can use the following command in the kali linux terminal:
```
~# sudo apt install nuclei
```
After installation you can check if everything installed properly by:
```
~# nuclei -h                   
Nuclei is a fast, template based vulnerability scanner focusing
on extensive configurability, massive extensibility and ease of use.

Usage:
  nuclei [flags]

Flags:
TARGET:
   -u, -target string[]          target URLs/hosts to scan
   -l, -list string              path to file containing a list of target URLs/hosts to scan (one per line)
   -eh, -exclude-hosts string[]  hosts to exclude to scan from the input list (ip, cidr, hostname)
   -resume string                resume scan using resume.cfg (clustering will be disabled)
   -sa, -scan-all-ips            scan all the IP's associated with dns record
   -iv, -ip-version string[]     IP version to scan of hostname (4,6) - (default 4)

TARGET-FORMAT:
   -im, -input-mode string        mode of input file (list, burp, jsonl, yaml, openapi, swagger) (default "list")
   -ro, -required-only            use only required fields in input format when generating requests
   -sfv, -skip-format-validation  skip format validation (like missing vars) when parsing input file

TEMPLATES:
   -nt, -new-templates                    run only new templates added in latest nuclei-templates release
   -ntv, -new-templates-version string[]  run new templates added in specific version
   -as, -automatic-scan                   automatic web scan using wappalyzer technology detection to tags mapping
   -t, -templates string[]                list of template or template directory to run (comma-separated, file)
   -turl, -template-url string[]          template url or list containing template urls to run (comma-separated, file)
   -ai, -prompt string                    generate and run template using ai prompt
   -w, -workflows string[]                list of workflow or workflow directory to run (comma-separated, file)
   -wurl, -workflow-url string[]          workflow url or list containing workflow urls to run (comma-separated, file)
   -validate                              validate the passed templates to nuclei
   -nss, -no-strict-syntax                disable strict syntax check on templates
   -td, -template-display                 displays the templates content
   -tl                                    list all available templates
   -tgl                                   list all available tags
   -sign                                  signs the templates with the private key defined in NUCLEI_SIGNATURE_PRIVATE_KEY env variable
   -code                                  enable loading code protocol-based templates
   -dut, -disable-unsigned-templates      disable running unsigned templates or templates with mismatched signature
   -esc, -enable-self-contained           enable loading self-contained templates
   -egm, -enable-global-matchers          enable loading global matchers templates
   -file                                  enable loading file templates

FILTERING:
   -a, -author string[]               templates to run based on authors (comma-separated, file)
   -tags string[]                     templates to run based on tags (comma-separated, file)
   -etags, -exclude-tags string[]     templates to exclude based on tags (comma-separated, file)
   -itags, -include-tags string[]     tags to be executed even if they are excluded either by default or configuration
   -id, -template-id string[]         templates to run based on template ids (comma-separated, file, allow-wildcard)
   -eid, -exclude-id string[]         templates to exclude based on template ids (comma-separated, file)
   -it, -include-templates string[]   path to template file or directory to be executed even if they are excluded either by default or configuration
   -et, -exclude-templates string[]   path to template file or directory to exclude (comma-separated, file)
   -em, -exclude-matchers string[]    template matchers to exclude in result
   -s, -severity value[]              templates to run based on severity. Possible values: info, low, medium, high, critical, unknown
   -es, -exclude-severity value[]     templates to exclude based on severity. Possible values: info, low, medium, high, critical, unknown
   -pt, -type value[]                 templates to run based on protocol type. Possible values: dns, file, http, headless, tcp, workflow, ssl, websocket, whois, code, javascript
   -ept, -exclude-type value[]        templates to exclude based on protocol type. Possible values: dns, file, http, headless, tcp, workflow, ssl, websocket, whois, code, javascript
   -tc, -template-condition string[]  templates to run based on expression condition

OUTPUT:
   -o, -output string            output file to write found issues/vulnerabilities
   -sresp, -store-resp           store all request/response passed through nuclei to output directory
   -srd, -store-resp-dir string  store all request/response passed through nuclei to custom directory (default "output")
   -silent                       display findings only
   -nc, -no-color                disable output content coloring (ANSI escape codes)
   -j, -jsonl                    write output in JSONL(ines) format
   -irr, -include-rr -omit-raw   include request/response pairs in the JSON, JSONL, and Markdown outputs (for findings only) [DEPRECATED use -omit-raw] (default true)
   -or, -omit-raw                omit request/response pairs in the JSON, JSONL, and Markdown outputs (for findings only)
   -ot, -omit-template           omit encoded template in the JSON, JSONL output
   -nm, -no-meta                 disable printing result metadata in cli output
   -ts, -timestamp               enables printing timestamp in cli output
   -rdb, -report-db string       nuclei reporting database (always use this to persist report data)
   -ms, -matcher-status          display match failure status
   -me, -markdown-export string  directory to export results in markdown format
   -se, -sarif-export string     file to export results in SARIF format
   -je, -json-export string      file to export results in JSON format
   -jle, -jsonl-export string    file to export results in JSONL(ine) format
   -rd, -redact string[]         redact given list of keys from query parameter, request header and body

CONFIGURATIONS:
   -config string                        path to the nuclei configuration file
   -tp, -profile string                  template profile config file to run
   -tpl, -profile-list                   list community template profiles
   -fr, -follow-redirects                enable following redirects for http templates
   -fhr, -follow-host-redirects          follow redirects on the same host
   -mr, -max-redirects int               max number of redirects to follow for http templates (default 10)
   -dr, -disable-redirects               disable redirects for http templates
   -rc, -report-config string            nuclei reporting module configuration file
   -H, -header string[]                  custom header/cookie to include in all http request in header:value format (cli, file)
   -V, -var value                        custom vars in key=value format
   -r, -resolvers string                 file containing resolver list for nuclei
   -sr, -system-resolvers                use system DNS resolving as error fallback
   -dc, -disable-clustering              disable clustering of requests
   -passive                              enable passive HTTP response processing mode
   -fh2, -force-http2                    force http2 connection on requests
   -ev, -env-vars                        enable environment variables to be used in template
   -cc, -client-cert string              client certificate file (PEM-encoded) used for authenticating against scanned hosts
   -ck, -client-key string               client key file (PEM-encoded) used for authenticating against scanned hosts
   -ca, -client-ca string                client certificate authority file (PEM-encoded) used for authenticating against scanned hosts
   -sml, -show-match-line                show match lines for file templates, works with extractors only
   -ztls                                 use ztls library with autofallback to standard one for tls13 [Deprecated] autofallback to ztls is enabled by default
   -sni string                           tls sni hostname to use (default: input domain name)
   -dka, -dialer-keep-alive value        keep-alive duration for network requests.
   -lfa, -allow-local-file-access        allows file (payload) access anywhere on the system
   -lna, -restrict-local-network-access  blocks connections to the local / private network
   -i, -interface string                 network interface to use for network scan
   -at, -attack-type string              type of payload combinations to perform (batteringram,pitchfork,clusterbomb)
   -sip, -source-ip string               source ip address to use for network scan
   -rsr, -response-size-read int         max response size to read in bytes
   -rss, -response-size-save int         max response size to read in bytes (default 1048576)
   -reset                                reset removes all nuclei configuration and data files (including nuclei-templates)
   -tlsi, -tls-impersonate               enable experimental client hello (ja3) tls randomization
   -hae, -http-api-endpoint string       experimental http api endpoint

INTERACTSH:
   -iserver, -interactsh-server string  interactsh server url for self-hosted instance (default: oast.pro,oast.live,oast.site,oast.online,oast.fun,oast.me)
   -itoken, -interactsh-token string    authentication token for self-hosted interactsh server
   -interactions-cache-size int         number of requests to keep in the interactions cache (default 5000)
   -interactions-eviction int           number of seconds to wait before evicting requests from cache (default 60)
   -interactions-poll-duration int      number of seconds to wait before each interaction poll request (default 5)
   -interactions-cooldown-period int    extra time for interaction polling before exiting (default 5)
   -ni, -no-interactsh                  disable interactsh server for OAST testing, exclude OAST based templates

FUZZING:
   -ft, -fuzzing-type string           overrides fuzzing type set in template (replace, prefix, postfix, infix)
   -fm, -fuzzing-mode string           overrides fuzzing mode set in template (multiple, single)
   -fuzz                               enable loading fuzzing templates (Deprecated: use -dast instead)
   -dast                               enable / run dast (fuzz) nuclei templates
   -dts, -dast-server                  enable dast server mode (live fuzzing)
   -dtr, -dast-report                  write dast scan report to file
   -dtst, -dast-server-token string    dast server token (optional)
   -dtsa, -dast-server-address string  dast server address (default "localhost:9055")
   -dfp, -display-fuzz-points          display fuzz points in the output for debugging
   -fuzz-param-frequency int           frequency of uninteresting parameters for fuzzing before skipping (default 10)
   -fa, -fuzz-aggression string        fuzzing aggression level controls payload count for fuzz (low, medium, high) (default "low")
   -cs, -fuzz-scope string[]           in scope url regex to be followed by fuzzer
   -cos, -fuzz-out-scope string[]      out of scope url regex to be excluded by fuzzer

UNCOVER:
   -uc, -uncover                  enable uncover engine
   -uq, -uncover-query string[]   uncover search query
   -ue, -uncover-engine string[]  uncover search engine (shodan,censys,fofa,shodan-idb,quake,hunter,zoomeye,netlas,criminalip,publicwww,hunterhow,google,odin,binaryedge) (default shodan)
   -uf, -uncover-field string     uncover fields to return (ip,port,host) (default "ip:port")
   -ul, -uncover-limit int        uncover results to return (default 100)
   -ur, -uncover-ratelimit int    override ratelimit of engines with unknown ratelimit (default 60 req/min) (default 60)

RATE-LIMIT:
   -rl, -rate-limit int               maximum number of requests to send per second (default 150)
   -rld, -rate-limit-duration value   maximum number of requests to send per second (default 1s)
   -rlm, -rate-limit-minute int       maximum number of requests to send per minute (DEPRECATED)
   -bs, -bulk-size int                maximum number of hosts to be analyzed in parallel per template (default 25)
   -c, -concurrency int               maximum number of templates to be executed in parallel (default 25)
   -hbs, -headless-bulk-size int      maximum number of headless hosts to be analyzed in parallel per template (default 10)
   -headc, -headless-concurrency int  maximum number of headless templates to be executed in parallel (default 10)
   -jsc, -js-concurrency int          maximum number of javascript runtimes to be executed in parallel (default 120)
   -pc, -payload-concurrency int      max payload concurrency for each template (default 25)
   -prc, -probe-concurrency int       http probe concurrency with httpx (default 50)

OPTIMIZATIONS:
   -timeout int                     time to wait in seconds before timeout (default 10)
   -retries int                     number of times to retry a failed request (default 1)
   -ldp, -leave-default-ports       leave default HTTP/HTTPS ports (eg. host:80,host:443)
   -mhe, -max-host-error int        max errors for a host before skipping from scan (default 30)
   -te, -track-error string[]       adds given error to max-host-error watchlist (standard, file)
   -nmhe, -no-mhe                   disable skipping host from scan based on errors
   -project                         use a project folder to avoid sending same request multiple times
   -project-path string             set a specific project path (default "/tmp")
   -spm, -stop-at-first-match       stop processing HTTP requests after the first match (may break template/workflow logic)
   -stream                          stream mode - start elaborating without sorting the input
   -ss, -scan-strategy value        strategy to use while scanning(auto/host-spray/template-spray) (default auto)
   -irt, -input-read-timeout value  timeout on input read (default 3m0s)
   -nh, -no-httpx                   disable httpx probing for non-url input
   -no-stdin                        disable stdin processing

HEADLESS:
   -headless                        enable templates that require headless browser support (root user on Linux will disable sandbox)
   -page-timeout int                seconds to wait for each page in headless mode (default 20)
   -sb, -show-browser               show the browser on the screen when running templates with headless mode
   -ho, -headless-options string[]  start headless chrome with additional options
   -sc, -system-chrome              use local installed Chrome browser instead of nuclei installed
   -lha, -list-headless-action      list available headless actions

DEBUG:
   -debug                     show all requests and responses
   -dreq, -debug-req          show all sent requests
   -dresp, -debug-resp        show all received responses
   -p, -proxy string[]        list of http/socks5 proxy to use (comma separated or file input)
   -pi, -proxy-internal       proxy all internal requests
   -ldf, -list-dsl-function   list all supported DSL function signatures
   -tlog, -trace-log string   file to write sent requests trace log
   -elog, -error-log string   file to write sent requests error log
   -version                   show nuclei version
   -hm, -hang-monitor         enable nuclei hang monitoring
   -v, -verbose               show verbose output
   -profile-mem string        generate memory (heap) profile & trace files
   -vv                        display templates loaded for scan
   -svd, -show-var-dump       show variables dump for debugging
   -vdl, -var-dump-limit int  limit the number of characters displayed in var dump (default 255)
   -ep, -enable-pprof         enable pprof debugging server
   -tv, -templates-version    shows the version of the installed nuclei-templates
   -hc, -health-check         run diagnostic check up

UPDATE:
   -ut, -update-templates            update nuclei-templates to latest released version
   -ud, -update-template-dir string  custom directory to install / update nuclei-templates
   -duc, -disable-update-check       disable automatic nuclei/templates update check

STATISTICS:
   -stats                    display statistics about the running scan
   -sj, -stats-json          display statistics in JSONL(ines) format
   -si, -stats-interval int  number of seconds to wait between showing a statistics update (default 5)
   -mp, -metrics-port int    port to expose nuclei metrics on (default 9092)
   -hps, -http-stats         enable http status capturing (experimental)

CLOUD:
   -auth                           configure projectdiscovery cloud (pdcp) api key (default true)
   -tid, -team-id string           upload scan results to given team id (optional) (default "none")
   -cup, -cloud-upload             upload scan results to pdcp dashboard [DEPRECATED use -dashboard]
   -sid, -scan-id string           upload scan results to existing scan id (optional)
   -sname, -scan-name string       scan name to set (optional)
   -pd, -dashboard                 upload / view nuclei results in projectdiscovery cloud (pdcp) UI dashboard
   -pdu, -dashboard-upload string  upload / view nuclei results file (jsonl) in projectdiscovery cloud (pdcp) UI dashboard

AUTHENTICATION:
   -sf, -secret-file string[]  path to config file containing secrets for nuclei authenticated scan
   -ps, -prefetch-secrets      prefetch secrets from the secrets file


EXAMPLES:
Run nuclei on single host:
        $ nuclei -target example.com

Run nuclei with specific template directories:
        $ nuclei -target example.com -t http/cves/ -t ssl

Run nuclei against a list of hosts:
        $ nuclei -list hosts.txt

Run nuclei with a JSON output:
        $ nuclei -target example.com -json-export output.json

Run nuclei with sorted Markdown outputs (with environment variables):
        $ MARKDOWN_EXPORT_SORT_MODE=template nuclei -target example.com -markdown-export nuclei_report/

Additional documentation is available at: https://docs.nuclei.sh/getting-started/running

```
This command will print a help page that shows how to used nuclei. To test the program lets clone the following repo https://github.com/projectdiscovery/nuclei-templates-labs.git

Shout out to the nuclei team to making this really cool repo for execise and learning!

```
~# git clone https://github.com/projectdiscovery/nuclei-templates-labs.git
```
Navigate to the following directory:
```
~# cd nuclei-templates-labs/http/misconfiguration/phpmyadmin/phpmyadmin-misconfiguration
```
Inside the folder, run the docker-compose command to automatically setup the lab:
```
~# sudo docker-compose up
[+] Building 106.7s (13/13) FINISHED                                                                                                                    docker:default
 => [vulnerable-phpmyadmin internal] load build definition from Dockerfile                                                                                        0.1s
 => => transferring dockerfile: 2.06kB                                                                                                                            0.0s 
 => [vulnerable-phpmyadmin internal] load metadata for docker.io/library/debian:12                                                                                2.7s 
 => [vulnerable-phpmyadmin internal] load .dockerignore                                                                                                           0.0s
 => => transferring context: 2B                                                                                                                                   0.0s 
 => [vulnerable-phpmyadmin 1/9] FROM docker.io/library/debian:12@sha256:b6507e340c43553136f5078284c8c68d86ec8262b1724dde73c325e8d3dcdeba                         13.2s 
 => => resolve docker.io/library/debian:12@sha256:b6507e340c43553136f5078284c8c68d86ec8262b1724dde73c325e8d3dcdeba                                                0.0s
 => => sha256:b6507e340c43553136f5078284c8c68d86ec8262b1724dde73c325e8d3dcdeba 8.52kB / 8.52kB                                                                    0.0s 
 => => sha256:06adcd002b8d0c342b5997cea1a3015822dedf214f43d0d8e28fbf9578973505 1.02kB / 1.02kB                                                                    0.0s 
 => => sha256:c93961f83a1e578ef9b2105f1718e307c2e1c7811ba540c6e7176aa3e12752d7 453B / 453B                                                                        0.0s 
 => => sha256:ebed137c7c18cb1906fb8314eabc10611ddf49a281f8c1b5eab987a7137f749f 48.49MB / 48.49MB                                                                  9.7s 
 => => extracting sha256:ebed137c7c18cb1906fb8314eabc10611ddf49a281f8c1b5eab987a7137f749f                                                                         3.2s
 => [vulnerable-phpmyadmin 2/9] RUN apt-get update && apt install -y lsb-release apt-transport-https ca-certificates curl gnupg2                                 17.3s
 => [vulnerable-phpmyadmin 3/9] RUN curl -fsSL https://packages.sury.org/php/apt.gpg | gpg --dearmor -o /usr/share/keyrings/php-archive-keyring.gpg               0.7s 
 => [vulnerable-phpmyadmin 4/9] RUN echo "deb [signed-by=/usr/share/keyrings/php-archive-keyring.gpg] https://packages.sury.org/php/ $(lsb_release -sc) main" |   0.4s 
 => [vulnerable-phpmyadmin 5/9] RUN apt update && apt install -y php7.1 php7.1-mysql php7.1-json php7.1-mbstring php7.1-xml mariadb-server apache2 wget          57.6s 
 => [vulnerable-phpmyadmin 6/9] RUN sed -i 's/^bind-address/#bind-address/' /etc/mysql/mariadb.conf.d/50-server.cnf &&     echo "bind-address = 0.0.0.0" >> /etc  0.4s 
 => [vulnerable-phpmyadmin 7/9] RUN wget https://files.phpmyadmin.net/phpMyAdmin/5.0.1/phpMyAdmin-5.0.1-all-languages.tar.gz &&     tar xzf phpMyAdmin-5.0.1-all  4.1s 
 => [vulnerable-phpmyadmin 8/9] RUN cp /var/www/html/phpMyAdmin/config.sample.inc.php /var/www/html/phpMyAdmin/config.inc.php &&     sed -i "s/localhost/0.0.0.0  0.3s 
 => [vulnerable-phpmyadmin 9/9] RUN service mariadb start &&     mysql -u root -proot -e "ALTER USER 'root'@'localhost' IDENTIFIED BY 'root'; GRANT ALL ON *.* T  1.6s 
 => [vulnerable-phpmyadmin] exporting to image                                                                                                                    8.1s 
 => => exporting layers                                                                                                                                           8.1s 
 => => writing image sha256:f0bca386207c3e2cdc375c86ccb8509af66290591343b63c7ecd8f584321959d                                                                      0.0s 
 => => naming to docker.io/library/phpmyadmin-misconfiguration-vulnerable-phpmyadmin                                                                              0.0s 
[+] Running 1/2
 ✔ Network phpmyadmin-misconfiguration_default  Created                                                                                                           0.2s 
 ⠸ Container phpmyadmin-misconfiguration        Created                                                                                                           0.2s 
Attaching to phpmyadmin-misconfiguration
phpmyadmin-misconfiguration  | Starting MariaDB database server: mariadbd.
phpmyadmin-misconfiguration  | ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: NO)
phpmyadmin-misconfiguration  | AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 172.19.0.2. Set the 'ServerName' directive globally to suppress this message
```
Open new tab in terminal by ctrl+shift+t and you should see a 8080 port open which is our target:
```
~# netstat -aptn 
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:34507         0.0.0.0:*               LISTEN      -                   
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      -                   
tcp6       0      0 :::8080                 :::*                    LISTEN      -   
```
You can visit the phpmyadmin dashboard through browser by typing this "http://127.0.0.1:8080/phpMyAdmin/index.php" into your URL. But if you want to get the docker container ip you can used the following command:
```
~# sudo docker container ls -all
CONTAINER ID   IMAGE                                               COMMAND                  CREATED          STATUS          PORTS                                             NAMES
a8327268663c   phpmyadmin-misconfiguration-vulnerable-phpmyadmin   "/bin/sh -c 'service…"   28 seconds ago   Up 27 seconds   3306/tcp, 0.0.0.0:8080->80/tcp, :::8080->80/tcp   phpmyadmin-misconfiguration
~# sudo docker exec -it a8327268663c /bin/bash
root@a8327268663c:/# apt install net-tools
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following NEW packages will be installed:
  net-tools
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 243 kB of archives.
After this operation, 1001 kB of additional disk space will be used.
Get:1 http://deb.debian.org/debian-security bookworm-security/main amd64 net-tools amd64 2.10-0.1+deb12u2 [243 kB]
Fetched 243 kB in 0s (507 kB/s)   
debconf: delaying package configuration, since apt-utils is not installed
Selecting previously unselected package net-tools.
(Reading database ... 12133 files and directories currently installed.)
Preparing to unpack .../net-tools_2.10-0.1+deb12u2_amd64.deb ...
Unpacking net-tools (2.10-0.1+deb12u2) ...
Setting up net-tools (2.10-0.1+deb12u2) ...
root@a8327268663c:/# ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.18.0.2  netmask 255.255.0.0  broadcast 172.18.255.255
        ether 02:42:ac:12:00:02  txqueuelen 0  (Ethernet)
        RX packets 114  bytes 251091 (245.2 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 98  bytes 5526 (5.3 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 4  bytes 342 (342.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 4  bytes 342 (342.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

root@a8327268663c:/# exit

```
To get into the docker container you first need to get the container id and run the exec command like the above.
Now once you get the docker ip address, try to run the nuclei program in the same tab, like this:
```
~# nuclei -u http://172.18.0.2

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.4.4

                projectdiscovery.io

[WRN] Found 1 templates with syntax error (use -validate flag for further examination)
[INF] Current nuclei version: v3.4.4 (outdated)
[INF] Current nuclei-templates version: v10.2.7 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 55
[INF] Templates loaded for current scan: 8263
[INF] Executing 8060 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 203 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1777 (Reduced 1671 Requests)
[INF] Using Interactsh Server: oast.live
[phpmyadmin-panel] [http] [info] http://172.18.0.2/phpMyAdmin/index.php ["5.0.1"] [paths="/phpMyAdmin/index.php"]
[pma-server-import] [http] [high] http://172.18.0.2/phpMyAdmin/server_import.php [paths="/phpMyAdmin/server_import.php"]
[waf-detect:apachegeneric] [http] [info] http://172.18.0.2
[phpmyadmin-unauth-access] [http] [high] http://172.18.0.2/phpMyAdmin/index.php [path="/phpMyAdmin/index.php"]
[mysql-info] [javascript] [info] 172.18.0.2:3306 ["Version: 5.5.5-10.11.11-MariaDB-0+deb12u1","Transport: tcp"]
[mysql-user-enum] [javascript] [high] 172.18.0.2:3306 [""] [passwords="root",usernames="root"]
[mysql-detect] [tcp] [info] 172.18.0.2:3306
[mysql-show-databases] [javascript] [high] 172.18.0.2:3306 ["information_schema","mysql","performance_schema","sys"] [passwords="root",usernames="root"]
[mysql-native-password] [tcp] [info] 172.18.0.2:3306
[options-method] [http] [info] http://172.18.0.2 ["GET,POST,OPTIONS,HEAD"]
[http-missing-security-headers:strict-transport-security] [http] [info] http://172.18.0.2
[http-missing-security-headers:content-security-policy] [http] [info] http://172.18.0.2
[http-missing-security-headers:permissions-policy] [http] [info] http://172.18.0.2
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://172.18.0.2
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://172.18.0.2
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://172.18.0.2
[http-missing-security-headers:x-frame-options] [http] [info] http://172.18.0.2
[http-missing-security-headers:x-content-type-options] [http] [info] http://172.18.0.2
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://172.18.0.2
[http-missing-security-headers:referrer-policy] [http] [info] http://172.18.0.2
[http-missing-security-headers:clear-site-data] [http] [info] http://172.18.0.2
[apache-detect] [http] [info] http://172.18.0.2 ["Apache/2.4.62 (Debian)"]
[default-apache-test-all] [http] [info] http://172.18.0.2 ["Apache/2.4.62 (Debian)"]
[default-apache2-page] [http] [info] http://172.18.0.2
[INF] Scan completed in 1m. 25 matches found.
```
We can see that we have a several findings, nuclei by default also classify the vulnerability based on severity. We can see that the phpmyadmin has been misconfigured to not used any authentication, thus, making it extremely dangerous. A simple finding but sometimes happen in real life scenario.
Now lets move on the next nuclei lab, we will try analyze emqx dashboard. To anyone who doesn't EMQX, it is a MQTT broker for IoT data infrastructure. You can search for more what is MQTT broker, explaining requires s significant amount of time.
To prepare it go to folder nuclei-templates-labs/http/default-logins/emqx/emqx-default-login and run the docker compose like previous lab:
```
~# sudo docker-compose up       
[+] Running 7/7
 ✔ emqx Pulled                                                                                                                          31.9s 
   ✔ 61320b01ae5e Pull complete                                                                                                         12.0s 
   ✔ bfb3422f2ac5 Pull complete                                                                                                          1.6s 
   ✔ 113479ba6062 Pull complete                                                                                                          2.9s 
   ✔ 1ed145083d40 Pull complete                                                                                                         22.5s 
   ✔ 8fd7fdfbc9e9 Pull complete                                                                                                          4.6s 
   ✔ 4f4fb700ef54 Pull complete                                                                                                          6.8s 
[+] Running 3/4
 ✔ Network emqx-default-login_default     Created                                                                                        0.2s 
 ✔ Volume "emqx-default-login_emqx_data"  Created                                                                                        0.0s 
 ✔ Volume "emqx-default-login_emqx_log"   Created                                                                                        0.0s 
 ⠸ Container emqx                         Created                                                                                        0.2s 
Attaching to emqx
emqx  | WARNING: Default (insecure) Erlang cookie is in use.
emqx  | WARNING: Configure node.cookie in /opt/emqx/etc/emqx.conf or override from environment variable EMQX_NODE__COOKIE
emqx  | WARNING: NOTE: Use the same cookie for all nodes in the cluster.
emqx  | EMQX_RPC__PORT_DISCOVERY [rpc.port_discovery]: manual
emqx  | EMQX_CLUSTER__STATIC__SEEDS [cluster.static.seeds]: [...]
emqx  | EMQX_CLUSTER__STATIC__SEEDS [cluster.static.seeds.1]: emqx@node1.emqx.io
emqx  | EMQX_CLUSTER__DISCOVERY_STRATEGY [cluster.discovery_strategy]: static
emqx  | EMQX_NODE__NAME [node.name]: emqx@node1.emqx.io
emqx  | Listener tcp:default on 0.0.0.0:1883 started.
emqx  | Listener ssl:default on 0.0.0.0:8883 started.
emqx  | Listener ws:default on 0.0.0.0:8083 started.
emqx  | Listener wss:default on 0.0.0.0:8084 started.
emqx  | 
emqx  | =====================================================================
emqx  | You are currently using the EMQX Community License included with this software.
emqx  | Permitted Use: Free use of a single node in your internal environment.
emqx  | What Requires a Different License:
emqx  |  - Clustered deployments (more than one node).
emqx  |  - Commercial use in SaaS, hosted services, or embedded/resold products.
emqx  | To enable clustering or use EMQX for external commercial purposes, a commercial license is required.
emqx  | Visit https://emqx.com/apply-licenses/emqx to apply for a license.
emqx  | (Clustering for non-profit or educational purposes may qualify for a free license - please inquire via the link above)
emqx  | =====================================================================
emqx  | Listener http:dashboard on :18083 started.
emqx  | EMQX Enterprise 5.10.0 is running now!
```
You can go to dashboard by visiting port 18083. But first we need to find the ip address of the docker image like in the previous section:

```
~# sudo docker container ls -all              
CONTAINER ID   IMAGE              COMMAND                  CREATED          STATUS          PORTS                                                                                                                                                                                                                    NAMES
013ed2416ea6   emqx/emqx:latest   "/usr/bin/docker-ent…"   26 seconds ago   Up 25 seconds   4370/tcp, 0.0.0.0:1883->1883/tcp, :::1883->1883/tcp, 0.0.0.0:8083-8084->8083-8084/tcp, :::8083-8084->8083-8084/tcp, 0.0.0.0:8883->8883/tcp, :::8883->8883/tcp, 0.0.0.0:18083->18083/tcp, :::18083->18083/tcp, 5369/tcp   emqx
~# sudo docker exec -it 013ed2416ea6 /bin/bash
emqx@013ed2416ea6:/opt/emqx$ ifconfig
bash: ifconfig: command not found
emqx@013ed2416ea6:/opt/emqx$ apt install net-tools
E: Could not open lock file /var/lib/dpkg/lock-frontend - open (13: Permission denied)
E: Unable to acquire the dpkg frontend lock (/var/lib/dpkg/lock-frontend), are you root?
emqx@013ed2416ea6:/opt/emqx$ exit
```
As you can see we cannot found out the ip address like previous section because we don't have root account. Thus, we need to find the other alternative like this:
```
~# sudo docker container ls -all              
CONTAINER ID   IMAGE              COMMAND                  CREATED         STATUS         PORTS                                                                                                                                                                                                                    NAMES
013ed2416ea6   emqx/emqx:latest   "/usr/bin/docker-ent…"   2 minutes ago   Up 2 minutes   4370/tcp, 0.0.0.0:1883->1883/tcp, :::1883->1883/tcp, 0.0.0.0:8083-8084->8083-8084/tcp, :::8083-8084->8083-8084/tcp, 0.0.0.0:8883->8883/tcp, :::8883->8883/tcp, 0.0.0.0:18083->18083/tcp, :::18083->18083/tcp, 5369/tcp   emqx
~# sudo docker network ls       
NETWORK ID     NAME                                  DRIVER    SCOPE
557560062c24   bridge                                bridge    local
145b77ffa341   emqx-default-login_default            bridge    local
3c76bc717ebc   host                                  host      local
27185d508568   none                                  null      local
e28e226f1ea4   phpmyadmin-misconfiguration_default   bridge    local
ifconfig br-145b77ffa341
br-145b77ffa341: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.19.0.1  netmask 255.255.0.0  broadcast 172.19.255.255
        inet6 fe80::42:50ff:fe20:e8b6  prefixlen 64  scopeid 0x20<link>
        ether 02:42:50:20:e8:b6  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```
Rather than going inside the docker instance and run ifconfig, we can use network utility from docker. As you can see for our container, docker made an adapter, thus, we can use the id and check for the network using ifconfig follow with "br-"
```
~# nmap -sn 172.19.0.1/24
Starting Nmap 7.95 ( https://nmap.org ) at 2025-08-09 12:16 EDT
Nmap scan report for 172.19.0.2 (172.19.0.2)
Host is up (0.000052s latency).
MAC Address: 02:42:AC:13:00:02 (Unknown)
Nmap scan report for 172.19.0.1 (172.19.0.1)
Host is up.
Nmap done: 256 IP addresses (2 hosts up) scanned in 2.06 seconds
```
To find the docker ip address we can used ping scan to find which ip is running our docker instance on except the 172.19.0.1 since thats the gateway. We found its in 172.19.0.2.
```
~# nuclei -u http://172.19.0.2:18083

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.4.4

                projectdiscovery.io

[WRN] Found 1 templates with syntax error (use -validate flag for further examination)
[INF] Current nuclei version: v3.4.4 (outdated)
[INF] Current nuclei-templates version: v10.2.7 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 55
[INF] Templates loaded for current scan: 8263
[INF] Executing 8060 signed templates from projectdiscovery/nuclei-templates
[WRN] Loading 203 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Templates clustered: 1777 (Reduced 1671 Requests)
[INF] Using Interactsh Server: oast.live
[emqx-default-login] [http] [high] http://172.19.0.2:18083/api/v5/login [path="/api/v5/login"]
[http-missing-security-headers:referrer-policy] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:clear-site-data] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:cross-origin-embedder-policy] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:cross-origin-opener-policy] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:permissions-policy] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:x-frame-options] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:x-content-type-options] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:cross-origin-resource-policy] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:strict-transport-security] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:content-security-policy] [http] [info] http://172.19.0.2:18083
[http-missing-security-headers:x-permitted-cross-domain-policies] [http] [info] http://172.19.0.2:18083
[emqx-panel] [http] [info] http://172.19.0.2:18083
[cowboy-detect] [http] [info] http://172.19.0.2:18083
[options-method] [http] [info] http://172.19.0.2:18083 ["HEAD, GET, OPTIONS"]
[INF] Scan completed in 1m. 15 matches found.
                                              
```
As you can see nuclei found that the emqx dashboard used a default login to the emqx dashboard that its also extremely dangerous and easily exploitable. Its easy but sometimes overlook by developer to secure.
